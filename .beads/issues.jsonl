{"id":"digihub-chatbot-0yh","title":"Increase chunk size and overlap parameters","description":"**Type:** enhancement","acceptance_criteria":"- [ ] Increase chunk size to 1500-2000 tokens\n- [ ] Increase overlap to 150-200 tokens\n- [ ] Consider adaptive chunking based on document structure\n- [ ] Use semantic boundaries rather than just token counts\n\n---","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.266845+05:30","updated_at":"2026-02-04T13:01:59.517301+05:30","closed_at":"2026-02-04T13:01:59.517301+05:30","close_reason":"Increased chunk size from 1000 to 1500 tokens and overlap from 100 to 150 tokens in both config.py (default values) and chunking_params.py enum","labels":["data-pipeline","medium"]}
{"id":"digihub-chatbot-0yz","title":"Fix contextual service lines overriding user authorization","description":"**Type:** bug\n\nFor session-dependent queries, retrieval is restricted to previous session's service lines, even if user is authorized for more. Follow-up questions about different topics get incomplete results.\n\n**File:** response_generator.py:426-472\n**Example:** User authorized for Billing, but follow-up restricted to previous topic (Airport Solutions)","acceptance_criteria":"- [ ] Don't restrict to previous service lines for follow-ups\n- [ ] Use full authorized service lines for retrieval\n- [ ] Only use contextual filtering as a boost, not restriction","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-04T14:40:46.075444+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-04T14:46:33.123474+05:30","closed_at":"2026-02-04T14:46:33.123484+05:30","labels":["critical","query-pipeline","retrieval"]}
{"id":"digihub-chatbot-101","title":"Implement hybrid search (BM25 keyword + semantic)","description":"Combine keyword/BM25 scoring with semantic vector similarity for retrieval. Formula: final_score = 0.7 * semantic_score + 0.3 * keyword_score. This fixes queries like 'What is CI Analysis?' where the chunk exists but semantic similarity alone doesn't rank it high enough due to 'What is X?' pattern matching.","status":"closed","priority":1,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-05T19:45:33.233552+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-05T19:47:35.999399+05:30","closed_at":"2026-02-05T19:47:35.999399+05:30","close_reason":"Implemented hybrid search with 70% semantic + 30% keyword scoring. Added _tokenize(), _extract_key_phrases(), and _calculate_keyword_score() methods. Keyword scoring considers: term frequency matches, heading matches (30% boost), exact phrase matches in heading (40% boost). Updated scoring loop, logging, and docstring.","labels":["digihub-chatbot-query-pipeline"]}
{"id":"digihub-chatbot-111","title":"Add validChunk field to uploaded chunks","description":"**Type:** bug","acceptance_criteria":"- [ ] Add validChunk = \"yes\" to document structure\n- [ ] Implement chunk validation logic\n- [ ] Run migration script for existing chunks\n\n---","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.263881+05:30","updated_at":"2026-02-04T12:22:57.755895+05:30","closed_at":"2026-02-04T12:22:57.755897+05:30","labels":["critical","data-pipeline","schema"]}
{"id":"digihub-chatbot-2bq","title":"Remove unused questionsEmbedding from CosmosDB retrieval query","description":"Removed unused question similarity logic from retrieval. Cleaned up VectorDistance(c.questionsEmbedding) from query and related processing.","status":"closed","priority":3,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-14T19:19:56.710786+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-14T19:20:02.664021+05:30","closed_at":"2026-02-14T19:20:02.664021+05:30","close_reason":"Removed unused questionsEmbedding query","labels":["cleanup","query-pipeline","retrieval"]}
{"id":"digihub-chatbot-2qj","title":"Fix SITA DataConnect routing and Two-Stage Retrieval conflict","description":"Fix SITA DataConnect queries not finding correct content.\n\n**Root Cause:** \n- Definitional queries like 'What is SITA DataConnect?' trigger Two-Stage Retrieval\n- Stage 1 searches General Info only, which scores 0.93 on 'SITA Messaging' content\n- This prevents Stage 2 from searching Community Messaging KB (ID 340) where actual DataConnect content lives\n- LLM-based keyword detection was unreliable\n\n**Solution (Code-based keyword detection):**\n1. Added PRODUCT_KEYWORDS dict in response_generator.py:\n   - 'dataconnect' -\u003e 340 (Community Messaging KB)\n   - 'sdc' -\u003e 340\n   - 'sitatex' -\u003e 340\n2. If product keyword found in query:\n   - Query is not classified as 'truly generic'\n   - Two-Stage Retrieval is skipped for definitional queries\n   - Product's service line (340) is added to search\n3. Raised MIN_CONFIDENCE_THRESHOLD from 0.5 to 0.75 for Stage 1\n\n**Files Modified:**\n- src/chatbot/response_generator.py","status":"closed","priority":1,"issue_type":"task","assignee":"zohaib.tanwir@gmail.com","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-07T14:06:32.641231+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-07T19:04:20.038467+05:30","closed_at":"2026-02-07T19:04:20.038467+05:30","close_reason":"Implemented code-based product keyword detection in response_generator.py. PRODUCT_KEYWORDS dict maps 'dataconnect/sdc/sitatex' to service line 340. Skips Two-Stage Retrieval and includes product service line in search when keyword detected. Also raised MIN_CONFIDENCE_THRESHOLD to 0.75."}
{"id":"digihub-chatbot-2u1","title":"Create unit tests for dataprocessor.py","description":"**Type:** testing\n**Priority:** CRITICAL\n**Coverage Target:** 80%\n\nCreate unit tests for the core document processing engine.\n\n**File:** data-pipeline/tests/test_dataprocessor.py\n\n**Test Cases Required:**\n\n1. **Chunking Tests**\n   - test_chunk_document_respects_size_limit\n   - test_chunk_document_maintains_overlap\n   - test_chunk_document_empty_content\n   - test_chunk_document_small_content\n\n2. **Image Path Processing Tests**\n   - test_update_image_paths_forward_slash\n   - test_update_image_paths_absolute_url\n   - test_update_image_paths_no_images\n\n3. **Chunk Validation Tests**\n   - test_validate_chunk_minimum_tokens\n   - test_validate_chunk_heading_only\n   - test_validate_chunk_valid_content\n   - test_validate_chunk_whitespace_only\n\n4. **Duplicate Detection Tests**\n   - test_detect_exact_duplicate\n   - test_detect_near_duplicate\n   - test_reset_duplicate_tracking\n   - test_jaccard_similarity_calculation\n\n5. **Question Generation Integration Tests**\n   - test_process_chunk_generates_questions\n   - test_process_chunk_question_fallback\n   - test_process_chunk_invalid_skips_questions\n\n6. **Embedding Generation Tests**\n   - test_process_chunk_generates_embeddings\n   - test_process_chunk_questions_embedding\n   - test_process_chunk_embedding_error_handling\n\n7. **Full Pipeline Tests**\n   - test_process_document_end_to_end\n   - test_process_document_with_images\n   - test_process_document_marks_invalid_chunks\n\n**Dependencies to Mock:**\n- AzureOpenAIService\n- EmbeddingService\n- QuestionGeneratorService\n- CosmosDB operations","status":"open","priority":1,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-04T16:49:35.032524+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-04T16:49:35.032524+05:30","labels":["critical","data-pipeline","testing"]}
{"id":"digihub-chatbot-30m","title":"Vocabulary mismatch causes retrieval failures (Option C - deferred)","description":"**Problem:** Query 'I have a dispute with an invoice, who to contact?' returns out-of-scope because the User Guide uses 'support case' terminology instead of 'dispute'.\n\n**Root Cause:** Keyword search fails when user vocabulary doesn't match document vocabulary.\n\n**Solution (Option C - deferred):** Add query synonym expansion using LLM:\n1. Before keyword scoring, expand query with synonyms\n2. 'dispute' → ['dispute', 'support case', 'complaint', 'billing issue']\n3. Keyword search now matches vocabulary variations\n\n**Deferred:** Will implement after Option A is validated.\n\n**Files to modify:**\n- src/services/retrieval_service.py - Add synonym expansion before keyword scoring","acceptance_criteria":"- [ ] LLM generates synonyms for key query terms\n- [ ] Synonyms are used in keyword scoring calculation\n- [ ] Original query terms still prioritized over synonyms\n- [ ] No significant latency increase (cache common expansions)","status":"closed","priority":2,"issue_type":"bug","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-06T14:48:59.84519+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-07T14:06:00.564611+05:30","closed_at":"2026-02-07T14:06:00.564611+05:30","close_reason":"Implemented synonym expansion in retrieval_service.py with _synonyms dictionary and _expand_with_synonyms() method. Keyword scoring now expands 'dispute' to match 'support', 'case', etc.","labels":["medium","query-pipeline","retrieval"]}
{"id":"digihub-chatbot-389","title":"AIR Dashboard content not ranking for incidents query","description":"Query 'How can I find report and statistic about incidents?' returns Euro CAB content instead of AIR Dashboard from Operational Support.\n\n## Root Cause (Confirmed via CosmosDB queries)\n1. AIR Dashboard chunk has heading 'View Company Incidents' - matches 'incidents' but not 'report'\n2. Euro CAB chunks have 'report' in headings (baggage surveys) - gets 40% phrase boost\n3. User's 'report' means 'dashboard/view' but matches Euro CAB's 'survey report'\n\n## Fix Implemented\nAdded synonyms in retrieval_service.py:\n- 'report' → includes 'view' (matches 'View Company Incidents')\n- 'incidents' ↔ 'incident' (singular/plural)\n\n## AIR Dashboard Chunks Found\n- chunk-0: 'DIGIHUB AIR DASHBOARD' (User Guide)\n- chunk-2: 'View Company Incidents' (directly relevant)\n- chunk-3: 'Open Incident Resolution'\n\n## Status\nFix implemented - needs testing","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-07T19:44:33.696097+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-07T21:09:51.438248+05:30","closed_at":"2026-02-07T21:09:51.438248+05:30","close_reason":"Fixed by adding 'view' to 'report' synonyms. AIR Dashboard 'View Company Incidents' now ranks for incidents queries."}
{"id":"digihub-chatbot-5by","title":"Create unit tests for query_analyzer.py","description":"**Type:** testing\n**Priority:** CRITICAL\n**Coverage Target:** 80%\n\nCreate unit tests for query classification and analysis module.\n\n**File:** query-pipeline/tests/tests/test_query_analyzer.py\n\n**Test Cases Required:**\n\n1. **Language Detection Tests**\n   - test_analyze_query_english\n   - test_analyze_query_german\n   - test_analyze_query_french\n   - test_analyze_query_spanish (parametrized)\n\n2. **Session Dependency Tests**\n   - test_analyze_query_detects_session_dependency\n   - test_analyze_query_independent_query\n   - test_analyze_query_pronoun_detection\n\n3. **Service Line Extraction Tests**\n   - test_analyze_query_extracts_service_lines\n   - test_analyze_query_multiple_service_lines\n   - test_analyze_query_no_service_lines\n\n4. **Query Type Tests**\n   - test_analyze_query_handles_acronyms\n   - test_analyze_query_information_type\n   - test_analyze_query_how_to_type\n\n5. **Error Handling Tests**\n   - test_analyze_query_llm_error_fallback\n   - test_analyze_query_invalid_response\n\n**Dependencies to Mock:**\n- AzureOpenAIService","status":"closed","priority":1,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-04T16:49:24.568368+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-08T19:35:04.65994+05:30","closed_at":"2026-02-08T19:35:04.659943+05:30","labels":["critical","query-pipeline","testing"]}
{"id":"digihub-chatbot-5ho","title":"Fix image path backslash to forward slash","description":"**Type:** bug","acceptance_criteria":"- [ ] Change backslash to forward slash in path replacement\n- [ ] Test image rendering in markdown output\n\n---","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.267832+05:30","updated_at":"2026-02-04T13:07:35.720939+05:30","closed_at":"2026-02-04T13:07:35.720939+05:30","close_reason":"Changed backslash to forward slash in image path replacement (lines 453 and 503) for proper cross-platform markdown image rendering","labels":["data-pipeline","low"]}
{"id":"digihub-chatbot-5qq","title":"Create unit tests for response_generator.py","description":"**Type:** testing\n**Priority:** CRITICAL\n**Coverage Target:** 80%\n\nCreate comprehensive unit tests for the main RAG orchestration engine.\n\n**File:** query-pipeline/tests/tests/test_response_generator.py\n\n**Test Cases Required:**\n\n1. **Reference Resolution Tests**\n   - test_resolve_query_references_with_pronouns\n   - test_resolve_query_references_no_pronouns\n   - test_resolve_query_references_session_independent\n\n2. **Service Line Determination Tests**\n   - test_determine_service_lines_uses_all_authorized\n   - test_determine_service_lines_no_keyword_restriction\n   - test_determine_service_lines_impersonation_mode\n\n3. **Out-of-Scope Detection Tests**\n   - test_detect_out_of_scope_explicit_true\n   - test_detect_out_of_scope_explicit_false_trusted\n   - test_detect_out_of_scope_low_confidence\n   - test_detect_out_of_scope_text_matching\n\n4. **Relevance Filtering Tests**\n   - test_filter_relevant_chunks_no_forced_minimum\n   - test_filter_relevant_chunks_empty_result\n   - test_filter_relevant_chunks_all_relevant\n\n5. **Contextual Service Lines Tests**\n   - test_get_contextual_service_lines_no_restriction\n   - test_get_contextual_service_lines_session_dependent\n\n6. **Integration Tests**\n   - test_generate_response_happy_path\n   - test_generate_response_out_of_scope\n   - test_generate_response_unauthorized\n\n**Dependencies to Mock:**\n- QueryAnalyzer\n- RelevanceJudge\n- AuthorizationChecker\n- ContextManager\n- RetreivalService\n- SessionDBService\n- AzureOpenAIService","status":"closed","priority":1,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-04T16:49:15.025742+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-08T19:35:02.959029+05:30","closed_at":"2026-02-08T19:35:02.959063+05:30","labels":["critical","query-pipeline","testing"]}
{"id":"digihub-chatbot-5zd","title":"Phase 2D: Improve out-of-scope detection for irrelevant content","description":"Queries like 'requirement to install cute services' return irrelevant content from Bag Manager. Need better out-of-scope detection when retrieved content doesn't actually answer the query.","status":"open","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-07T13:02:20.015827+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-07T13:02:20.015827+05:30"}
{"id":"digihub-chatbot-63a","title":"Fix VectorDistance to similarity conversion (negative scores bug)","description":"**Type:** bug\n**Severity:** CRITICAL\n\n## Problem\nCosmosDB VectorDistance with cosine metric returns values in [0, 2] range, but code assumed [0, 1] and used 1 - distance formula.\n\nThis caused:\n- Distance 1.2 → Similarity -0.2 (NEGATIVE!)\n- Distance 1.8 → Similarity -0.8 (NEGATIVE!)\n- Good chunks filtered out due to negative hybrid scores\n\n## Fix\nAdded distance_to_similarity() helper that normalizes [0,2] to [0,1] and clamps result.\n\n## File\ndigihub-chatbot-query-pipeline/src/services/retrieval_service.py\n\n## Commit\n7959fd2","status":"closed","priority":1,"issue_type":"bug","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-04T17:28:04.573013+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-04T17:28:09.761367+05:30","closed_at":"2026-02-04T17:28:09.761374+05:30","labels":["critical","query-pipeline","retrieval"]}
{"id":"digihub-chatbot-6hh","title":"Create test infrastructure (conftest.py, pytest.ini, .coveragerc)","description":"**Type:** infrastructure\n\nCreate shared test infrastructure for both pipelines:\n\n1. **conftest.py** (both pipelines)\n   - Centralized fixtures for mocking Azure services\n   - Shared mock data fixtures\n   - Auto-mock for Azure dependencies\n\n2. **pytest.ini** (both pipelines)\n   - Test discovery patterns\n   - Asyncio mode settings\n   - Markers (unit, integration, slow)\n\n3. **.coveragerc** (both pipelines)\n   - Source paths\n   - Exclusion patterns\n   - Minimum coverage threshold (70%)\n   - Branch coverage enabled\n\n4. **Update requirements.txt**\n   - Add pytest-cov==4.1.0\n   - Add pytest-xdist==3.5.0\n\n**Files to create:**\n- query-pipeline/tests/conftest.py\n- query-pipeline/pytest.ini\n- query-pipeline/.coveragerc\n- data-pipeline/tests/conftest.py\n- data-pipeline/pytest.ini\n- data-pipeline/.coveragerc","status":"open","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-04T16:49:03.347359+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-04T16:49:03.347359+05:30","labels":["data-pipeline","infrastructure","query-pipeline","testing"]}
{"id":"digihub-chatbot-6jf","title":"Add relevance filtering before response generation","description":"**Type:** enhancement","acceptance_criteria":"- [ ] Call RelevanceJudge.judge_chunks_relevance() after retrieval\n- [ ] Filter out non-relevant chunks before response generation\n- [ ] Log filtered chunks for debugging\n- [ ] Consider using relevance scores to weight chunks\n\n---\n\n# Medium Priority Issues","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.265764+05:30","updated_at":"2026-02-04T12:53:47.389712+05:30","closed_at":"2026-02-04T12:53:47.389716+05:30","labels":["high","query-pipeline"]}
{"id":"digihub-chatbot-73r","title":"Phase 1A: Boost General Info (ID 0) by 25% for definitional queries","description":"Prioritize DigiHub User Guide content for 'What is X?' type queries. Detect definitional query patterns and apply 25% score boost to chunks from service line ID 0 (General Info).","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-07T12:05:40.02241+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-07T12:09:04.188207+05:30","closed_at":"2026-02-07T12:09:04.188207+05:30","close_reason":"Implemented: Added 25% boost for General Info (service line 0) on definitional queries"}
{"id":"digihub-chatbot-7z2","title":"Increase session context window from 1 to 5 messages","description":"**Type:** enhancement","acceptance_criteria":"- [ ] Increase context window to 5 recent Q\u0026A pairs\n- [ ] Make window size configurable via environment variable\n- [ ] Consider intelligent context selection based on relevance\n\n---","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.264651+05:30","updated_at":"2026-02-04T12:53:46.765512+05:30","closed_at":"2026-02-04T12:53:46.765521+05:30","labels":["high","query-pipeline"]}
{"id":"digihub-chatbot-89x","title":"Relaxed relevance judge prompt to be more inclusive","description":"The relevance judge was too strict, filtering out 100% of chunks for many queries.\n\nChanges to RELEVANCE_JUDGE_TEMPLATE_BULK in prompt_template.py:\n- Changed from requiring 'direct and substantial answer' to accepting 'relevant information that can help answer'\n- Added instruction: 'Be inclusive rather than exclusive - if the chunk could potentially help the user, mark it as relevant'\n\nThis reduces false negatives where relevant content was incorrectly filtered out.","status":"closed","priority":1,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-05T11:05:03.139447+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-05T11:05:09.783635+05:30","closed_at":"2026-02-05T11:05:09.783635+05:30","close_reason":"Implemented - relevance judge prompt updated in prompt_template.py","labels":["high","query-pipeline","relevance"]}
{"id":"digihub-chatbot-9mv","title":"Switch retrieval from question-first to content-first ORDER BY","description":"Change ORDER BY in retrieve_with_question_matching() to use c.embedding instead of c.questionsEmbedding. Adjust hybrid weights from 0.7/0.3 to 0.3/0.7 (content-first). This fixes CI Analysis queries where 'What is CI Analysis?' fails because no matching question was generated.","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-05T12:13:30.096863+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-05T12:14:24.632814+05:30","closed_at":"2026-02-05T12:14:24.632814+05:30","close_reason":"Implemented content-first retrieval: Changed ORDER BY from questionsEmbedding to embedding, adjusted hybrid weights from 0.7/0.3 to 0.3/0.7","labels":["digihub-chatbot-query-pipeline"]}
{"id":"digihub-chatbot-a3d","title":"Remove question similarity from hybrid scoring - use content-only","description":"Set question_boost_weight=0.0 so hybrid_score uses only content similarity. Question-based matching was boosting 'What is X?' pattern matches over actual relevant content.","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-05T18:45:00.907759+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-05T18:45:29.390828+05:30","closed_at":"2026-02-05T18:45:29.390828+05:30","close_reason":"Set question_boost_weight=0.0 in both default parameter and rag_retriever_agent call. Updated docstring. Now hybrid_score = content_similarity only.","labels":["digihub-chatbot-query-pipeline"]}
{"id":"digihub-chatbot-ac1","title":"Airport Committee: Meeting Minutes ranking higher than General Info","description":"**Issue:** 'What is Airport Committee?' returns Meeting Minutes instead of General Info definition.\n\n**General Info has definition:**\n\u003e Airport Committee - Documentation access for Airport Committee customers. The library contains presentations, user guides, and meeting summaries.\n\n**Root Cause:** `contentType` is not set in CosmosDB metadata for these chunks. Authority penalty (0.85 for MeetingNotes) is never applied - falls back to DEFAULT_AUTHORITY (0.95).\n\n**Fix Options:**\n1. Update CosmosDB chunks to have correct `contentType` metadata\n2. Detect MeetingNotes from file path (e.g., `Meeting Minutes/`) and apply penalty\n\n**File:** retrieval_service.py or data pipeline","status":"open","priority":2,"issue_type":"bug","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-09T17:30:00+05:30","created_by":"claude","updated_at":"2026-02-09T17:30:00+05:30","labels":["content-ranking","query-pipeline","retrieval"]}
{"id":"digihub-chatbot-apv","title":"Fix service line filtering to not exclude relevant documents","description":"**Type:** bug\n\nQuery analyzer guesses service lines from keywords, but may miss relevant ones. Query 'billing problem with my bag' extracts only ['Billing'], missing Bag Manager docs entirely.\n\n**File:** response_generator.py:886-903\n**Problem:** Keyword-based service line detection is unreliable","acceptance_criteria":"- [ ] Consider searching all authorized service lines first\n- [ ] Use service line detection as boost, not filter\n- [ ] Or expand detected service lines to include related ones","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-04T14:40:37.918038+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-04T14:46:00.888724+05:30","closed_at":"2026-02-04T14:46:00.888735+05:30","labels":["critical","query-pipeline","retrieval"]}
{"id":"digihub-chatbot-aqk","title":"Add questionsEmbedding field to data pipeline","description":"**Type:** bug","acceptance_criteria":"- [ ] Generate synthetic questions for each chunk using LLM\n- [ ] Create questionsEmbedding from concatenated questions\n- [ ] Store both embedding and questionsEmbedding in document\n- [ ] Add questions array field for debugging\n\n---","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.263235+05:30","updated_at":"2026-02-04T12:22:57.576868+05:30","closed_at":"2026-02-04T12:22:57.576872+05:30","labels":["critical","data-pipeline","schema"]}
{"id":"digihub-chatbot-aut","title":"Implement metadata-based filtering in retrieval","description":"**Type:** enhancement","acceptance_criteria":"- [ ] Store metadata fields in chunks during indexing\n- [ ] Pass extracted metadata from query analyzer to retrieval\n- [ ] Add metadata filters to CosmosDB query\n- [ ] Implement fallback to unfiltered query if no results\n\n---","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.266247+05:30","updated_at":"2026-02-04T13:01:59.924425+05:30","closed_at":"2026-02-04T13:01:59.924425+05:30","close_reason":"Implemented metadata-based filtering in retrieval with ENABLE_METADATA_FILTERING config flag, supporting contentType and year filters from query analyzer","labels":["medium","query-pipeline"]}
{"id":"digihub-chatbot-b9e","title":"Fix Step 6.6: Restore restriction for generic queries while adding user guides for specific queries","description":"Fixed logic: Generic queries (no service line detected) RESTRICT to [0, 440] only. Specific queries (service line detected) ADD [0, 440] alongside. Previous change removed restriction, causing WorldTracer's 2,968 chunks to drown out user guide content.","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-05T13:25:27.872883+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-05T13:25:28.206817+05:30","closed_at":"2026-02-05T13:25:28.206817+05:30","close_reason":"Fixed","labels":["digihub-chatbot-query-pipeline"]}
{"id":"digihub-chatbot-boj","title":"Implement proper context formatting for LLM","description":"**Type:** enhancement","acceptance_criteria":"- [ ] Format context as structured markdown or numbered sections\n- [ ] Include clear labels for each chunk (source file, section heading)\n- [ ] Use proper JSON formatting if structure is needed\n\n---","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.265051+05:30","updated_at":"2026-02-04T12:53:47.052726+05:30","closed_at":"2026-02-04T12:53:47.05273+05:30","labels":["high","query-pipeline"]}
{"id":"digihub-chatbot-btu","title":"Remove duplicate translation key in JSON schema","description":"**Type:** bug","acceptance_criteria":"- [ ] Remove duplicate key\n- [ ] Consolidate instruction into one clear definition\n\n---","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.268125+05:30","updated_at":"2026-02-04T13:07:18.121267+05:30","closed_at":"2026-02-04T13:07:18.121267+05:30","close_reason":"Consolidated duplicate 'translation' keys in LANGUAGE_DETECTION_TEMPLATE JSON schema into single clear definition","labels":["low","query-pipeline"]}
{"id":"digihub-chatbot-bv4","title":"Create unit tests for relevance_judge.py","description":"**Type:** testing\n**Priority:** HIGH\n**Coverage Target:** 75%\n\nCreate unit tests for LLM-based chunk relevance evaluation.\n\n**File:** query-pipeline/tests/tests/test_relevance_judge.py\n\n**Test Cases Required:**\n\n1. **Relevance Filtering Tests**\n   - test_judge_chunks_relevance_filters_irrelevant\n   - test_judge_chunks_relevance_all_relevant\n   - test_judge_chunks_relevance_none_relevant\n\n2. **Edge Case Tests**\n   - test_judge_chunks_relevance_empty_chunks\n   - test_judge_chunks_relevance_single_chunk\n   - test_judge_chunks_relevance_duplicate_service_lines\n\n3. **Error Handling Tests**\n   - test_judge_chunks_relevance_llm_error_fallback\n   - test_judge_chunks_relevance_invalid_response\n   - test_judge_chunks_relevance_timeout\n\n4. **Response Parsing Tests**\n   - test_parse_llm_response_valid\n   - test_parse_llm_response_missing_field\n   - test_parse_llm_response_wrong_type\n\n**Dependencies to Mock:**\n- AzureOpenAIService","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-04T16:49:42.319578+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-08T19:35:08.278242+05:30","closed_at":"2026-02-08T19:35:08.278245+05:30","labels":["high","query-pipeline","testing"]}
{"id":"digihub-chatbot-c39","title":"Add service line filtering after relevance judge","description":"Added post-relevance-judge filtering to ensure chunks match detected service lines.\n\nChanges to _filter_relevant_chunks() in response_generator.py:\n- Accept detected_service_names parameter\n- After relevance judge, filter chunks to match detected services (case-insensitive)\n- If no chunks match detected services, clear relevant_chunks to trigger fallback\n- Fallback prefers chunks from detected service lines\n\nThis prevents queries like 'Airport Solutions billing' from returning Airport Committee content.","status":"closed","priority":1,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-05T11:05:18.389206+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-05T11:05:23.373799+05:30","closed_at":"2026-02-05T11:05:23.373799+05:30","close_reason":"Implemented - service line filtering added to response_generator.py","labels":["high","query-pipeline","retrieval"]}
{"id":"digihub-chatbot-ceb","title":"Phase 2E: Fix session entity resolution for follow-up questions","description":"Follow-up questions like 'How do I raise a new one?' after asking about incidents are being answered for Service Requests instead of Incidents. Entity resolution needs to track the specific entity type from context.","status":"open","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-07T13:02:21.304198+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-07T13:02:21.304198+05:30"}
{"id":"digihub-chatbot-cq5","title":"Consolidate out-of-scope detection to single consistent signal","description":"**Type:** bug\n\nOut-of-scope detection uses 4 contradictory signals that can fire independently, causing flaky behavior where same query gets different results.\n\n**File:** response_generator.py:687-768\n**Signals:** is_out_of_scope boolean, confidence\u003c0.4, text patterns, type=generic+confidence\u003c0.6","acceptance_criteria":"- [ ] Use single source of truth for out-of-scope (LLM is_out_of_scope boolean)\n- [ ] Remove conflicting confidence threshold checks\n- [ ] Remove text pattern matching fallback\n- [ ] Test consistency across repeated queries","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-04T14:40:30.041903+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-04T14:44:58.638499+05:30","closed_at":"2026-02-04T14:44:58.638516+05:30","labels":["critical","query-pipeline","response"]}
{"id":"digihub-chatbot-dti","title":"Add CI/CD test integration in Azure Pipelines","description":"**Type:** infrastructure\n**Priority:** MEDIUM\n\nAdd automated test execution and coverage reporting in Azure Pipelines.\n\n**Files to Create/Modify:**\n\n1. **azure-pipelines.test.yml** (new)\n   - Trigger on main and develop branches\n   - Install dependencies\n   - Run pytest with coverage\n   - Publish test results (JUnit format)\n   - Publish coverage results (Cobertura format)\n   - Fail build if coverage \u003c 70%\n\n2. **azure-pipelines.ci.yml** (modify)\n   - Add test stage before build\n   - Gate deployment on test success\n\n**Pipeline Steps:**\n```yaml\n- task: UsePythonVersion@0\n- script: pip install -r requirements.txt\n- script: pytest --cov=src --cov-report=xml --cov-fail-under=70\n- task: PublishTestResults@2\n- task: PublishCodeCoverageResults@1\n```\n\n**Acceptance Criteria:**\n- [ ] Tests run automatically on PR\n- [ ] Coverage report visible in Azure DevOps\n- [ ] Build fails if coverage drops below 70%\n- [ ] Test results visible in PR checks","status":"open","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-04T16:50:15.138556+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-04T16:50:15.138556+05:30","labels":["ci-cd","infrastructure","testing"]}
{"id":"digihub-chatbot-dww","title":"Add chunk quality validation in data pipeline","description":"**Type:** enhancement","acceptance_criteria":"- [ ] Implement minimum content length validation (\u003e50 tokens)\n- [ ] Check for meaningful content beyond just headers\n- [ ] Detect and filter duplicate/near-duplicate chunks\n- [ ] Set validChunk = \"no\" for low-quality chunks\n\n---\n\n# Low Priority Issues","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.267522+05:30","updated_at":"2026-02-04T13:03:45.919099+05:30","closed_at":"2026-02-04T13:03:45.919099+05:30","close_reason":"Implemented chunk quality validation with: 1) Token-based minimum content check (MIN_TOKEN_COUNT=50 tokens), 2) Header-only content detection, 3) Exact duplicate detection using content hash, 4) Near-duplicate detection using Jaccard similarity (threshold=0.85), 5) Placeholder content detection. Added reset_duplicate_tracking() called per-file in dataprocessor.","labels":["data-pipeline","medium"]}
{"id":"digihub-chatbot-dx3","title":"Implement product/entity detection for generic queries (Option A)","description":"**Problem:** Queries like 'What is SITA Mission Watch?' are classified as generic (no service line detected) and restricted to service lines [0, 440]. However, the content exists in Euro CAB (460).\n\n**Root Cause:** The query analyzer doesn't detect that 'SITA Mission Watch' is a product/entity name that should trigger a broader search.\n\n**Solution (Option A):** Add product/entity detection before classification:\n1. If query mentions a specific product name, classify as 'product-specific, unknown service line'\n2. Search ALL authorized service lines (not just [0, 440])\n3. Let hybrid search find the right content\n\n**Files to modify:**\n- src/chatbot/query_analyzer.py - Add entity detection output\n- src/chatbot/response_generator.py - Update Step 6.6 logic for detected entities\n\n**Test Cases:**\n- 'What is SITA Mission Watch?' → should return content from Euro CAB (460)\n- 'What is DigiHub?' → should still work (content in [0, 440])\n- 'How do I reopen a Billing case?' → should still work (Billing detected as service line)","acceptance_criteria":"- [ ] Query analyzer outputs detected product/entity names\n- [ ] Detected entities trigger broader service line search (all authorized)\n- [ ] Generic queries without entities still restricted to [0, 440]\n- [ ] Working queries with explicit service line names remain unaffected\n- [ ] Add logging for entity detection to monitor false positives","status":"closed","priority":1,"issue_type":"bug","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-06T14:48:47.498796+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-06T14:51:03.288405+05:30","closed_at":"2026-02-06T14:51:03.288405+05:30","close_reason":"Implemented product/entity detection in query analyzer and response generator. Queries with detected entities now search all authorized service lines.","labels":["high","query-pipeline","retrieval"]}
{"id":"digihub-chatbot-dz6","title":"Output parser Python optimization - remove LLM call","description":"Replaced OUTPUT_PARSING LLM call with Python regex for ~2s savings per request. Created output_parser.py with USE_PYTHON_OUTPUT_PARSER toggle.","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-14T19:19:55.655968+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-14T19:20:02.485619+05:30","closed_at":"2026-02-14T19:20:02.485619+05:30","close_reason":"Implemented Python-based output parsing","labels":["optimization","performance","query-pipeline"]}
{"id":"digihub-chatbot-dzp","title":"Remove MIN_RELEVANCE_CHUNKS forcing irrelevant content","description":"**Type:** bug\n\nWhen relevance judge returns fewer chunks than MIN_RELEVANCE_CHUNKS, code forces top N chunks by score even if they're irrelevant. This injects garbage into LLM context.\n\n**File:** response_generator.py:668-675\n**Problem:** If 0 chunks are relevant, still forces top 2 irrelevant chunks","acceptance_criteria":"- [ ] Don't force minimum chunks if relevance judge says none are relevant\n- [ ] Return empty/fewer chunks when appropriate\n- [ ] Let out-of-scope detection handle no-context cases","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-04T14:40:22.179668+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-04T14:44:14.844087+05:30","closed_at":"2026-02-04T14:44:14.844093+05:30","labels":["critical","filtering","query-pipeline"]}
{"id":"digihub-chatbot-e9z","title":"SharePoint document analysis and gap identification","description":"Analyzed SharePoint document library to understand knowledge base content and identify gaps.\n\nFindings:\n- Total: 6.0GB, ~1,100 files (999 indexed for chatbot)\n- General Info (ID=0): 2 files, 10 chunks - Main DigiHub guide, Acronym list\n- Operational Support (ID=440): 2 files, 10 chunks - CI Analysis, Incidents, AIR Dashboard\n- Billing (ID=400): 61 files, 103 chunks - User guides, billing updates\n- Euro CAB: 64 files, 711 chunks - Meeting notes (dilutes search)\n- WorldTracer: 463 files, indexing in progress after DB reindex\n\nCreated SharePoint_Analysis_Report.docx with full analysis.","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-05T11:04:47.161342+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-05T11:04:53.057807+05:30","closed_at":"2026-02-05T11:04:53.057807+05:30","close_reason":"Completed SharePoint analysis and created report document","labels":["analysis","documentation","query-pipeline"]}
{"id":"digihub-chatbot-ehd","title":"Fix conflicting out-of-scope instructions in prompt template","description":"**Type:** bug\n\nRESPONSE_TEMPLATE has contradictory instructions for out-of-scope detection that confuse the LLM.\n\n**File:** prompt_template.py:311-323\n**Conflicts:**\n- 'Set is_out_of_scope=true if confidence \u003c 0.4'\n- 'Set is_out_of_scope=true if confidence 0.4-0.6 AND tangential'\n- 'High confidence (\u003e0.7) = in scope'","acceptance_criteria":"- [ ] Simplify to single clear instruction\n- [ ] Remove conflicting threshold guidance\n- [ ] Test LLM consistency with updated prompt","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-04T14:40:54.812092+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-04T14:47:03.958846+05:30","closed_at":"2026-02-04T14:47:03.95886+05:30","labels":["critical","prompts","query-pipeline"]}
{"id":"digihub-chatbot-eip","title":"Fix hybrid scoring calculation for legacy chunks","description":"Fixed hybrid scoring for legacy chunks - apply 15% penalty and use content-only scoring","acceptance_criteria":"- [ ] Fix scoring to properly handle legacy chunks\n- [ ] Consider penalizing legacy chunks slightly\n- [ ] Log when legacy chunks are included in results","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-04T14:40:06.62656+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-04T14:42:05.788339+05:30","closed_at":"2026-02-04T14:42:05.788353+05:30","labels":["critical","query-pipeline","retrieval"]}
{"id":"digihub-chatbot-f1v","title":"Improve citation processing code pattern","description":"**Type:** enhancement","acceptance_criteria":"- [ ] Make modification pattern explicit by reassigning result\n- [ ] Add return statement and capture it\n\n---","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.268471+05:30","updated_at":"2026-02-04T13:08:11.364446+05:30","closed_at":"2026-02-04T13:08:11.364446+05:30","close_reason":"Fixed citation processing pattern: explicitly capture return value from _process_citations() and reassign to structured_response. Updated docstring to clarify return value usage.","labels":["low","query-pipeline"]}
{"id":"digihub-chatbot-fie","title":"Phase 2A: Two-Stage Retrieval for definitional queries","description":"Search General Info (ID 0) first for definitional queries. If no relevant content found (low confidence), expand to other service lines. This ensures General Info is prioritized even when content is thin.","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-07T13:02:09.05277+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-07T13:04:17.223264+05:30","closed_at":"2026-02-07T13:04:17.223264+05:30","close_reason":"Implemented Two-Stage Retrieval: Stage 1 searches General Info only, Stage 2 expands if score \u003c 0.5"}
{"id":"digihub-chatbot-fkg","title":"Phase 1B: Increase UserGuide content type boost from 5% to 15%","description":"Prioritize user guides over newsletters/meeting minutes. Increase the content type boost for UserGuide/DigiHubUserGuide from 5% to 15% in retrieval_service.py.","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-07T12:05:40.992691+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-07T12:09:05.090714+05:30","closed_at":"2026-02-07T12:09:05.090714+05:30","close_reason":"Implemented: Increased UserGuide boost from 5% to 15%"}
{"id":"digihub-chatbot-gqn","title":"Review and optimize LLM prompts for query analysis","description":"Review all LLM prompts used in the query pipeline to improve reliability and consistency.\n\n**Background:**\n- LLM-based service line detection from keywords was unreliable\n- Query analyzer sometimes misclassifies queries (e.g., 'SITA DataConnect' not detected as Community Messaging KB)\n- Had to implement code-based keyword detection as a workaround\n\n**Prompts to Review:**\n1. LANGUAGE_DETECTION_TEMPLATE (query_analyzer.py) - Main query classification prompt\n2. RESPONSE_TEMPLATE (prompt_template.py) - Response generation prompt\n3. RELEVANCE_JUDGE_TEMPLATE_BULK (prompt_template.py) - Chunk relevance filtering\n4. Statement-to-question conversion instructions\n5. Synonym expansion instructions\n\n**Goals:**\n- Simplify prompts where possible\n- Improve service line detection accuracy\n- Reduce reliance on code-based workarounds\n- Ensure consistent JSON output format\n- Consider splitting monolithic prompts (related to digihub-chatbot-srv)\n\n**Files:**\n- src/enums/prompt_template.py\n- src/chatbot/query_analyzer.py","status":"open","priority":2,"issue_type":"task","assignee":"zohaib.tanwir@gmail.com","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-07T19:06:40.684671+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-07T19:06:40.684671+05:30","labels":["optimization","prompts","query-pipeline"]}
{"id":"digihub-chatbot-gre","title":"Fix ORDER BY to use questionsEmbedding instead of content embedding","description":"Fixed ORDER BY to use questionsEmbedding instead of embedding","acceptance_criteria":"- [ ] Change ORDER BY to use c.questionsEmbedding\n- [ ] Add fallback for legacy chunks without questionsEmbedding\n- [ ] Test retrieval quality improvement","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-04T14:39:58.772019+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-04T14:41:39.21753+05:30","closed_at":"2026-02-04T14:41:39.217547+05:30","labels":["critical","query-pipeline","retrieval"]}
{"id":"digihub-chatbot-hec","title":"Implement Content Authority + Recency scoring","description":"Replace narrow content type boost with a principled scoring system that combines:\n\n1. **Content Authority Tiers**: Multiplier based on content type hierarchy\n   - Tier 1 (Authoritative): UserGuide, DigiHubUserGuide (1.20x)\n   - Tier 2 (Technical): ReleaseNotes, TechnicalDoc (1.10x)\n   - Tier 3 (Neutral): FAQ, default (1.00x)\n   - Tier 4 (Supplementary): BillingUpdate, MeetingNotes, Survey (0.85x)\n\n2. **Recency Factor**: Newer documents rank higher\n   - 2025-2026: 1.10x boost\n   - 2023-2024: 1.00x (neutral)\n   - 2021-2022: 0.90x penalty\n   - Pre-2021: 0.85x penalty\n\n**Formula:** final_score = hybrid_score × authority_multiplier × recency_factor\n\n**Files to modify:**\n- src/services/retrieval_service.py\n\n**Fixes:**\n- Invoice dispute query returning 2021 newsletter instead of Billing User Guide\n- Generalizes content prioritization for future queries","status":"closed","priority":1,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-08T23:23:03.730739+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-08T23:24:02.850514+05:30","closed_at":"2026-02-08T23:24:02.850518+05:30"}
{"id":"digihub-chatbot-inb","title":"Fix generic queries to default to General Info and Operational Support service lines","description":"Generic queries (no detected service line) like 'How do I export to CSV?', 'What is CI Analysis?' return out-of-scope responses instead of finding answers in DigiHub documentation.\n\nRoot Cause:\n- No service line detected from generic query\n- System searches ALL service lines (4,390 chunks)\n- Euro Customer Advisory Board has 711 meeting note chunks that dilute results\n- Vector search returns semantically similar but irrelevant content\n- Relevance judge filters out everything, returning out-of-scope\n\nFix:\nWhen no service line is detected and query is not session-dependent, default to:\n- serviceNameid = 0 (General Info)\n- serviceNameid = 440 (Operational Support)\n\nThis ensures generic DigiHub questions find user guide content.","status":"closed","priority":1,"issue_type":"bug","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-05T11:04:35.664396+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-05T11:06:42.220088+05:30","closed_at":"2026-02-05T11:06:42.220088+05:30","close_reason":"Implemented - Generic queries now default to General Info (0) and Operational Support (440) service lines. Added Step 6.6 in response_generator.py that checks if detected_service_names is empty and is_session_dependent is False, then restricts retrieval to user guide sources.","labels":["high","query-pipeline","retrieval"]}
{"id":"digihub-chatbot-jis","title":"Create unit tests for authorization_checker.py","description":"**Type:** testing\n**Priority:** HIGH\n**Coverage Target:** 75%\n\nCreate unit tests for authorization validation module.\n\n**File:** query-pipeline/tests/tests/test_authorization_checker.py\n\n**Test Cases Required:**\n\n1. **Authorization Check Tests**\n   - test_check_authorization_user_subscribed\n   - test_check_authorization_user_not_subscribed\n   - test_check_authorization_impersonation_mode\n   - test_check_authorization_multiple_service_lines\n\n2. **Service Line Matching Tests**\n   - test_match_service_lines_exact_match\n   - test_match_service_lines_partial_match\n   - test_match_service_lines_no_match\n\n3. **Error Handling Tests**\n   - test_check_authorization_api_error\n   - test_check_authorization_invalid_response\n\n**Dependencies to Mock:**\n- AuthorizationService","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-04T16:49:49.295737+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-08T19:35:06.246474+05:30","closed_at":"2026-02-08T19:35:06.246476+05:30","labels":["high","query-pipeline","testing"]}
{"id":"digihub-chatbot-kmk","title":"Investigate and optimize response time performance","description":"Response times are slow and need optimization.\n\n**Symptoms:**\n- Queries take a long time to complete\n- User experience is impacted by slow responses\n\n**Timing logs added to response_generator.py:**\n- Step 1: Session Context retrieval\n- Step 2: Query Analysis (LLM call)\n- Step 7: Retrieval (CosmosDB vector search)\n- Step 7.5: Relevance Filter (LLM call)\n- Step 10: Response Generation (LLM call)\n- Total Pipeline time\n\n**Potential bottlenecks to investigate:**\n1. Multiple LLM calls (query analysis, relevance filter, response generation)\n2. CosmosDB vector search latency\n3. Session context retrieval\n4. Two-Stage Retrieval (2 retrieval calls for definitional queries)\n\n**Possible optimizations:**\n- Parallel LLM calls where possible\n- Caching for repeated queries\n- Reduce number of LLM calls (combine steps)\n- Optimize CosmosDB queries\n- Consider async processing\n\n**Files:**\n- src/chatbot/response_generator.py (timing logs added)","status":"open","priority":2,"issue_type":"task","assignee":"zohaib.tanwir@gmail.com","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-07T19:21:10.640941+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-07T19:21:10.640941+05:30","labels":["optimization","performance","query-pipeline"]}
{"id":"digihub-chatbot-lxr","title":"SITA Mission Watch - Content Gap","description":"Query 'What is SITA Mission Watch?' fails because no dedicated documentation exists.\n\n## CosmosDB Query Results\nOnly mentions found:\n1. Billing newsletters - product name change tables only\n2. Euro CAB chunk-37 - ONE useful sentence: 'SITA Mission Watch, the aviation industry's leading solution for flight tracking and flight monitoring, plus weather visualization...'\n\n## Problem\n- The only descriptive content is in chunk-37 with heading 'ASISTIM' (not 'Mission Watch')\n- Keyword search won't find it because heading doesn't match query\n- No dedicated Mission Watch documentation in SharePoint\n\n## Business Action Required\nAdd SITA Mission Watch documentation to SharePoint for indexing.\n\n## Workaround (if needed)\nCould add 'mission watch' to PRODUCT_KEYWORDS to route to Euro CAB (460), but this is a band-aid.","status":"open","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-07T20:13:41.255266+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-07T20:13:41.255266+05:30"}
{"id":"digihub-chatbot-mw2","title":"SITA Mission Watch: detected_entities not converted to service line IDs","description":"**Issue:** 'What is SITA Mission Watch?' returns 'no information' despite content existing in Euro CAB.\n\n**Log shows:**\n```\nEntity-specific query detected - entities: ['SITA Mission Watch']\nTwo-Stage Retrieval: Stage 1 - Searching service lines: [0]  ← Only General Info!\n```\n\n**Root Cause:** Current fix converts `detected_service_names` to IDs, but `detected_entities` are NOT converted. Entity 'SITA Mission Watch' was detected but didn't trigger search in Euro CAB (460) or Billing (400).\n\n**Content location:**\n- Billing Updates (product name table - no description)\n- Euro CAB/SITA Group Impact Report 2024.pdf\n\n**Fix:** Also convert `detected_entities` to service line IDs when possible, or expand Stage 1 to include all service lines when entities are detected.\n\n**File:** response_generator.py","status":"open","priority":2,"issue_type":"bug","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-09T17:30:00+05:30","created_by":"claude","updated_at":"2026-02-09T17:30:00+05:30","labels":["query-pipeline","retrieval","two-stage"]}
{"id":"digihub-chatbot-p0c","title":"Invoice dispute query returns old newsletter instead of Billing Guide","description":"Query 'I have a dispute with an invoice, who to contact?' returns content from 'Billing/Billing Updates/2021/04_2021_Billing Update.pdf' instead of Billing User Guide.\n\n## Current Synonym Expansion\n'dispute': ['support', 'case', 'complaint', 'issue', 'problem']\n\n## Investigation Needed\n1. Query CosmosDB for Billing (400) chunks with 'dispute', 'invoice', 'contact', 'support'\n2. Check what the Billing User Guide says about disputes\n3. Determine why 2021 newsletter ranks higher than user guide\n\n## Likely Cause\n- 2021 newsletter may have 'dispute' keyword in heading/content\n- Billing User Guide may use different terminology (e.g., 'support case')\n- Need to check contentType boosting (UserGuide should get 15% boost)","status":"open","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-07T20:58:14.614363+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-07T20:58:14.614363+05:30"}
{"id":"digihub-chatbot-pk2","title":"PRODUCT_KEYWORDS: Add SITA Data Connect mapping","description":"**Bug:** Query 'How can we install SITA Data Connect?' is treated as generic and restricted to user guides only.\n\n**Root cause:** 'sita data connect' not in PRODUCT_KEYWORDS mapping.\n\n**Fix:** Add 'sita data connect' → 340 (Community Messaging KB / SITA Messaging) to PRODUCT_KEYWORDS.\n\n**Affects:** Q5 (SITA Data Connect installation)\n\n**File:** src/chatbot/response_generator.py","status":"open","priority":2,"issue_type":"bug","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-09T12:00:00+05:30","created_by":"claude","updated_at":"2026-02-09T12:00:00+05:30","labels":["bug","query-pipeline","retrieval"]}
{"id":"digihub-chatbot-pvl","title":"Fix validChunk filter causing retrieval failures","description":"**Type:** bug","acceptance_criteria":"- [ ] Make filter conditional based on field existence\n- [ ] Add fallback query without filter if no results\n- [ ] Log when chunks are filtered by this condition\n\n---\n\n# High Priority Issues","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.264281+05:30","updated_at":"2026-02-04T12:26:37.047165+05:30","closed_at":"2026-02-04T12:26:37.047169+05:30","labels":["critical","query-pipeline","retrieval"],"dependencies":[{"issue_id":"digihub-chatbot-pvl","depends_on_id":"digihub-chatbot-111","type":"blocks","created_at":"2026-02-04T10:59:26.201899+05:30","created_by":"zohaibtanwir"}]}
{"id":"digihub-chatbot-q6g","title":"Create Streamlit test UI for chatbot testing","description":"Created a simple Streamlit chat UI for testing the DigiHub chatbot.\n\nFiles created:\n- ui/app.py - Chat interface with session persistence\n- ui/requirements.txt - streamlit\u003e=1.28.0, requests\u003e=2.31.0\n\nFeatures:\n- Chat interface with message history\n- Shows confidence, score, citations in expandable details\n- Configurable email/tenant in sidebar\n- Session ID tracking\n- Clear chat button\n\nRun with: streamlit run ui/app.py","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-05T11:05:32.340651+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-05T11:05:38.432338+05:30","closed_at":"2026-02-05T11:05:38.432338+05:30","close_reason":"Completed - Streamlit UI created in ui/app.py","labels":["query-pipeline","testing","ui"]}
{"id":"digihub-chatbot-rr3","title":"Reference Resolution: Use session entities for pronoun resolution","description":"**Bug:** When resolving pronouns like 'it', the system resolves to generic 'the service' instead of using session entities.\n\n**Evidence:**\n- Previous Q30: 'Tell me what is AIR dashboard doing?' → Answered correctly\n- Q31: 'Tell me more about trends and performances it is offering.'\n- Resolution: 'it' → 'the service' (WRONG)\n- Should resolve: 'it' → 'AIR Dashboard' (from session)\n\n**Fix:** Reference resolution should use session entities from previous messages.\n\n**Affects:** Q31 (trends and performances follow-up)\n\n**File:** src/chatbot/context_manager.py","status":"open","priority":2,"issue_type":"bug","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-09T12:00:00+05:30","created_by":"claude","updated_at":"2026-02-09T12:00:00+05:30","labels":["bug","query-pipeline","session-context","test-setup"]}
{"id":"digihub-chatbot-ry2","title":"Phase 2B: Query Rewriting for statement-style queries","description":"Convert statement-style queries to question format. Examples: 'I need report about incidents' → 'How do I find report about incidents'. This improves retrieval for natural language statements.","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-07T13:02:10.921118+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-07T13:04:18.314486+05:30","closed_at":"2026-02-07T13:04:18.314486+05:30","close_reason":"Implemented: Added statement-to-question conversion in prompt_template.py for 'I need X' → 'How do I find X' patterns"}
{"id":"digihub-chatbot-sbq","title":"Phase 2C: Synonym Expansion for vocabulary mismatch","description":"Add synonym mapping in query analyzer or retrieval. Key mappings: dispute→support case, complaint→issue, problem→incident. Ensures keyword matching works across vocabulary variations.","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-07T13:02:12.301703+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-07T13:04:19.194109+05:30","closed_at":"2026-02-07T13:04:19.194109+05:30","close_reason":"Implemented: Added synonym mappings in prompt_template.py for expanded queries (dispute→support case, complaint→issue, etc.)"}
{"id":"digihub-chatbot-sr0","title":"Implement structured out-of-scope detection","description":"**Type:** enhancement","acceptance_criteria":"- [ ] Add dedicated is_out_of_scope boolean to LLM response schema\n- [ ] Use confidence score thresholds as additional signal\n- [ ] Implement fuzzy matching or semantic similarity\n- [ ] Return structured response with explicit scope classification\n\n---","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.267171+05:30","updated_at":"2026-02-04T13:01:51.528495+05:30","closed_at":"2026-02-04T13:01:51.528495+05:30","close_reason":"Implemented structured out-of-scope detection with multiple signals: 1) Explicit is_out_of_scope boolean from LLM response schema, 2) Confidence score threshold (configurable via OUT_OF_SCOPE_CONFIDENCE_THRESHOLD, default 0.4), 3) Text-based matching fallback, 4) Generic type with low confidence check","labels":["medium","query-pipeline"]}
{"id":"digihub-chatbot-srv","title":"Split monolithic query analyzer prompt","description":"**Type:** enhancement","acceptance_criteria":"- [ ] Split into focused prompts for different concerns\n- [ ] Use smaller/faster models for simple tasks\n- [ ] Chain prompts with early exit conditions\n- [ ] Use structured output schemas (JSON mode) for each\n\n---","status":"in_progress","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.265408+05:30","updated_at":"2026-02-04T12:51:20.51799+05:30","labels":["high","query-pipeline"]}
{"id":"digihub-chatbot-str1","title":"Implement streaming response for Response Generation LLM","description":"**Goal:** Reduce perceived wait time by streaming the Response Generation LLM output to the UI.\n\n**Current:** User waits 12-15s for full response\n**After:** User sees text appearing after ~7s (pipeline processing), then streams for ~5s\n\n**Implementation Completed:**\n1. Added `get_response_from_agent_streaming()` method in response_generator.py - streams tokens using Azure OpenAI stream=True\n2. Added `generate_response_streaming()` method - full pipeline with streaming final response\n3. Created `/chat/stream` endpoint in chat_views.py using FastAPI StreamingResponse with SSE format\n4. Updated test UI (ui/app.py) with streaming toggle - parses SSE events and updates UI in real-time\n\n**SSE Event Types:**\n- `session`: Contains session_id\n- `token`: Contains streaming content\n- `metadata`: Contains final response, citations, confidence\n- `error`: Contains error message\n- `[DONE]`: Stream complete\n\n**Files Modified:**\n- src/views/chat_views.py - New /chat/stream endpoint\n- src/chatbot/response_generator.py - Two new streaming methods\n- ui/app.py - SSE client with streaming toggle","status":"closed","priority":1,"issue_type":"feature","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-10T10:30:00+05:30","created_by":"claude","updated_at":"2026-02-10T11:30:00+05:30","closed_at":"2026-02-10T11:30:00+05:30","close_reason":"Implemented streaming response generation with SSE endpoint and updated test UI","labels":["performance","streaming","ui"]}
{"id":"digihub-chatbot-syj","title":"Fix reference resolution disabled on service line change","description":"**Type:** bug\n\nReference resolution (resolving 'it', 'that', etc.) only runs when is_session_dependent=true. But when service lines change between questions, is_session_dependent is set to false, so pronouns are sent to retrieval unresolved.\n\n**File:** response_generator.py:489-499\n**Example:** 'Tell me more about it' sent as-is when topic changes","acceptance_criteria":"- [ ] Always check for references regardless of is_session_dependent\n- [ ] Resolve pronouns even when service line changes\n- [ ] Test with topic-switching conversations","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-04T14:40:14.473388+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-04T14:43:32.752773+05:30","closed_at":"2026-02-04T14:43:32.752778+05:30","labels":["context","critical","query-pipeline"]}
{"id":"digihub-chatbot-t9i","title":"Always include General Info and Operational Support in search pool","description":"Modify retrieval to always include serviceNameid=0 (General Info) and serviceNameid=440 (Operational Support) in the search pool alongside detected service lines. This ensures user guide content is always considered even when specific service lines are detected, preventing volume imbalance from drowning out important documentation.","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-05T12:22:09.128296+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-05T12:23:04.27959+05:30","closed_at":"2026-02-05T12:23:04.27959+05:30","close_reason":"Modified Step 6.6 to always include serviceNameid 0 (General Info) and 440 (Operational Support) in search pool, regardless of detected service lines. Uses set to avoid duplicates.","labels":["digihub-chatbot-query-pipeline"]}
{"id":"digihub-chatbot-tgx","title":"Add content type boosting for UserGuide and DigiHubUserGuide","description":"Billing and general queries return newsletters/meeting notes instead of user guides because:\n- 96 BillingUpdate chunks vs 5 DigiHubUserGuide chunks in Billing\n- No content type prioritization in scoring\n\nFix: Add scoring boost for contentType = 'UserGuide' or 'DigiHubUserGuide' in hybrid score calculation. This ensures user guide content ranks higher than newsletters/meeting notes for instructional queries.\n\nContent types to boost:\n- UserGuide (Operational Support docs)\n- DigiHubUserGuide (General Info, Billing user guides)\n\nContent types to NOT boost (or penalize):\n- BillingUpdate (newsletters)\n- MeetingNotes\n- Others\n- Survey","status":"closed","priority":1,"issue_type":"bug","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-05T11:42:59.354608+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-05T11:44:38.511109+05:30","closed_at":"2026-02-05T11:44:38.511109+05:30","close_reason":"Implemented content type boosting in retrieval_service.py:\n- Added USER_GUIDE_CONTENT_TYPES = {'UserGuide', 'DigiHubUserGuide'}\n- Added CONTENT_TYPE_BOOST = 0.05 (5% boost)\n- Applied boost after hybrid score calculation\n- Added logging for boosted chunks count and top chunk content type\nReady for testing.","labels":["high","query-pipeline","retrieval"]}
{"id":"digihub-chatbot-ts1","title":"Two-Stage Retrieval: Include detected service lines in Stage 1","description":"**Bug:** When LLM detects a specific service line (e.g., WorldTracer, Billing), Two-Stage Retrieval ignores it and only searches General Info.\n\n**Evidence from logs:**\n```\nDetected service lines from query: ['Billing'] (used for logging only)  ← IGNORED!\nTwo-Stage Retrieval: Stage 1 - Searching General Info only\n```\n\n**Fix:** Include detected service line in Stage 1 search alongside General Info.\n\n**Affects:** Q16 (WorldTracer PC requirements), Q27 (same), Q29 (Manage Subscriptions)\n\n**File:** src/chatbot/response_generator.py","status":"open","priority":2,"issue_type":"bug","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-09T12:00:00+05:30","created_by":"claude","updated_at":"2026-02-09T12:00:00+05:30","labels":["bug","query-pipeline","retrieval"]}
{"id":"digihub-chatbot-uq3","title":"Enable hybrid re-ranking in retrieval service","description":"**Type:** bug","acceptance_criteria":"- [ ] Uncomment hybrid scoring code block (lines 324-358)\n- [ ] Ensure hybrid score properly weights question vs content similarity\n- [ ] Implement minimum question similarity threshold\n- [ ] Add logging for retrieval quality metrics\n\n---","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.261422+05:30","updated_at":"2026-02-04T12:26:37.232917+05:30","closed_at":"2026-02-04T12:26:37.23292+05:30","labels":["critical","query-pipeline","retrieval"],"dependencies":[{"issue_id":"digihub-chatbot-uq3","depends_on_id":"digihub-chatbot-aqk","type":"blocks","created_at":"2026-02-04T10:59:25.837839+05:30","created_by":"zohaibtanwir"},{"issue_id":"digihub-chatbot-uq3","depends_on_id":"digihub-chatbot-111","type":"blocks","created_at":"2026-02-04T10:59:26.013347+05:30","created_by":"zohaibtanwir"}]}
{"id":"digihub-chatbot-vyh","title":"Create integration tests for end-to-end flows","description":"**Type:** testing\n**Priority:** LOW\n\nCreate integration tests that test full workflows with minimal mocking.\n\n**Query Pipeline Integration Tests:**\n\n1. **test_chat_flow_integration.py**\n   - test_full_chat_request_response\n   - test_multi_turn_conversation\n   - test_out_of_scope_handling\n   - test_authorization_flow\n\n2. **test_retrieval_flow_integration.py**\n   - test_full_retrieval_pipeline\n   - test_hybrid_ranking_integration\n   - test_relevance_filtering_integration\n\n**Data Pipeline Integration Tests:**\n\n1. **test_document_processing_integration.py**\n   - test_full_document_to_chunks\n   - test_document_with_images\n   - test_question_generation_flow\n   - test_embedding_generation_flow\n\n**Prerequisites:**\n- Mock only external services (Azure, CosmosDB)\n- Test internal component interactions\n- Use realistic test data\n- Mark with @pytest.mark.integration\n\n**Acceptance Criteria:**\n- [ ] Integration tests in separate directory\n- [ ] Can run independently from unit tests\n- [ ] Document setup requirements","status":"open","priority":3,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-04T16:50:25.429163+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-04T16:50:25.429163+05:30","labels":["data-pipeline","low","query-pipeline","testing"]}
{"id":"digihub-chatbot-whj","title":"Add comprehensive logging and monitoring","description":"**Type:** enhancement","acceptance_criteria":"- [ ] Add retrieval quality metrics logging\n- [ ] Log similarity scores for all retrieved chunks\n- [ ] Add latency tracking for each pipeline stage\n- [ ] Implement health check endpoints with detailed status","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.268758+05:30","updated_at":"2026-02-04T13:10:11.558734+05:30","closed_at":"2026-02-04T13:10:11.558734+05:30","close_reason":"Added comprehensive logging and monitoring: 1) Created src/utils/metrics.py with RetrievalMetrics, LatencyTracker, PipelineMetrics classes, 2) Added /actuator/health/detailed endpoint with CosmosDB and Azure OpenAI status checks and config reporting, 3) Integrated RetrievalMetrics.log_chunk_scores() for all retrieved chunks, 4) Added RetrievalMetrics.log_filtering_results() for threshold and relevance filtering","labels":["low","observability"]}
{"id":"digihub-chatbot-xkz","title":"Add minimum similarity threshold for retrieval","description":"**Type:** enhancement","acceptance_criteria":"- [ ] Set meaningful default threshold (0.3-0.4)\n- [ ] Make threshold configurable via environment variable\n- [ ] Log similarity scores for quality monitoring\n- [ ] Consider adaptive thresholds based on query type\n\n---","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.266544+05:30","updated_at":"2026-02-04T13:01:59.720443+05:30","closed_at":"2026-02-04T13:01:59.720443+05:30","close_reason":"Added MIN_SIMILARITY_THRESHOLD config (default 0.35) for retrieval quality control with logging of top 5 hybrid scores","labels":["medium","query-pipeline"]}
{"id":"digihub-chatbot-xlz","title":"Conversational message handling (greetings, thanks, farewells)","description":"Implemented instant friendly responses for conversational messages in multiple languages. Fast path for English greetings, LLM path for multi-language. Response time \u003c0.5s vs ~10s.","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-14T19:19:43.396224+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-14T19:19:54.17397+05:30","closed_at":"2026-02-14T19:19:54.17397+05:30","close_reason":"Implemented fast path for English and LLM-based detection for multi-language","labels":["performance","query-pipeline","ux"]}
{"id":"digihub-chatbot-yyt","title":"Content gaps: Missing definitional content for products","description":"Several products mentioned in queries have missing or insufficient content in the knowledge base.\n\n**Products with content gaps:**\n\n| Product | Status | Issue |\n|---------|--------|-------|\n| SITA DataConnect | Technical docs exist | No definitional/overview content - only release notes, system requirements |\n| SITA Mission Watch | Only table mention | Just listed in product name change table, no actual documentation |\n| SITA Border Control | No content | No documentation in knowledge base |\n| OptiFlight | No content | No documentation in knowledge base |\n\n**Impact:**\n- 'What is X?' queries return out-of-scope because no definitional content exists\n- Users cannot get basic information about these products\n\n**Recommendation:**\nBusiness team should add overview/definitional content for each product:\n- What the product is\n- Key features/benefits\n- Basic usage information\n\n**Related queries that fail:**\n- What is SITA DataConnect?\n- What is SITA Mission Watch?\n- What is SITA Border Control?\n- What do you know about OptiFlight?","status":"open","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-07T19:39:10.821523+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-07T19:39:10.821523+05:30","labels":["business-action","content-gap"]}
{"id":"digihub-chatbot-zom","title":"Improve existing test coverage to 80%","description":"**Type:** testing\n**Priority:** MEDIUM\n\nEnhance existing test files to improve coverage.\n\n**Query Pipeline - Existing Tests to Enhance:**\n\n1. **test_retrieval_service.py** (Current: ~60%, Target: 85%)\n   - Add tests for new hybrid scoring with legacy penalty\n   - Add tests for questionsEmbedding ORDER BY\n   - Add edge case tests for empty results\n\n2. **test_context_manager.py** (Current: ~50%, Target: 80%)\n   - Add tests for reference resolution edge cases\n   - Add tests for entity extraction failures\n   - Add parametrized tests for different pronoun types\n\n3. **test_session_service.py** (Current: ~40%, Target: 75%)\n   - Add tests for service line tracking\n   - Add tests for entity persistence\n   - Add error handling tests\n\n4. **test_auth_service.py** (Current: ~30%, Target: 70%)\n   - Add tests for subscription status variations\n   - Add tests for API timeout handling\n\n**Data Pipeline - Existing Tests to Enhance:**\n\n1. **test_question_generator_service.py** (Current: ~70%, Target: 85%)\n   - Add tests for new duplicate detection\n   - Add tests for Jaccard similarity\n   - Add tests for validChunk field","status":"open","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-04T16:49:59.172527+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-04T16:49:59.172527+05:30","labels":["data-pipeline","medium","query-pipeline","testing"]}
