{"id":"digihub-chatbot-0yh","title":"Increase chunk size and overlap parameters","description":"**Type:** enhancement","acceptance_criteria":"- [ ] Increase chunk size to 1500-2000 tokens\n- [ ] Increase overlap to 150-200 tokens\n- [ ] Consider adaptive chunking based on document structure\n- [ ] Use semantic boundaries rather than just token counts\n\n---","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.266845+05:30","updated_at":"2026-02-04T13:01:59.517301+05:30","closed_at":"2026-02-04T13:01:59.517301+05:30","close_reason":"Increased chunk size from 1000 to 1500 tokens and overlap from 100 to 150 tokens in both config.py (default values) and chunking_params.py enum","labels":["data-pipeline","medium"]}
{"id":"digihub-chatbot-0yz","title":"Fix contextual service lines overriding user authorization","description":"**Type:** bug\n\nFor session-dependent queries, retrieval is restricted to previous session's service lines, even if user is authorized for more. Follow-up questions about different topics get incomplete results.\n\n**File:** response_generator.py:426-472\n**Example:** User authorized for Billing, but follow-up restricted to previous topic (Airport Solutions)","acceptance_criteria":"- [ ] Don't restrict to previous service lines for follow-ups\n- [ ] Use full authorized service lines for retrieval\n- [ ] Only use contextual filtering as a boost, not restriction","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-04T14:40:46.075444+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-04T14:46:33.123474+05:30","closed_at":"2026-02-04T14:46:33.123484+05:30","labels":["critical","query-pipeline","retrieval"]}
{"id":"digihub-chatbot-111","title":"Add validChunk field to uploaded chunks","description":"**Type:** bug","acceptance_criteria":"- [ ] Add validChunk = \"yes\" to document structure\n- [ ] Implement chunk validation logic\n- [ ] Run migration script for existing chunks\n\n---","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.263881+05:30","updated_at":"2026-02-04T12:22:57.755895+05:30","closed_at":"2026-02-04T12:22:57.755897+05:30","labels":["critical","data-pipeline","schema"]}
{"id":"digihub-chatbot-5ho","title":"Fix image path backslash to forward slash","description":"**Type:** bug","acceptance_criteria":"- [ ] Change backslash to forward slash in path replacement\n- [ ] Test image rendering in markdown output\n\n---","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.267832+05:30","updated_at":"2026-02-04T13:07:35.720939+05:30","closed_at":"2026-02-04T13:07:35.720939+05:30","close_reason":"Changed backslash to forward slash in image path replacement (lines 453 and 503) for proper cross-platform markdown image rendering","labels":["data-pipeline","low"]}
{"id":"digihub-chatbot-6jf","title":"Add relevance filtering before response generation","description":"**Type:** enhancement","acceptance_criteria":"- [ ] Call RelevanceJudge.judge_chunks_relevance() after retrieval\n- [ ] Filter out non-relevant chunks before response generation\n- [ ] Log filtered chunks for debugging\n- [ ] Consider using relevance scores to weight chunks\n\n---\n\n# Medium Priority Issues","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.265764+05:30","updated_at":"2026-02-04T12:53:47.389712+05:30","closed_at":"2026-02-04T12:53:47.389716+05:30","labels":["high","query-pipeline"]}
{"id":"digihub-chatbot-7z2","title":"Increase session context window from 1 to 5 messages","description":"**Type:** enhancement","acceptance_criteria":"- [ ] Increase context window to 5 recent Q\u0026A pairs\n- [ ] Make window size configurable via environment variable\n- [ ] Consider intelligent context selection based on relevance\n\n---","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.264651+05:30","updated_at":"2026-02-04T12:53:46.765512+05:30","closed_at":"2026-02-04T12:53:46.765521+05:30","labels":["high","query-pipeline"]}
{"id":"digihub-chatbot-apv","title":"Fix service line filtering to not exclude relevant documents","description":"**Type:** bug\n\nQuery analyzer guesses service lines from keywords, but may miss relevant ones. Query 'billing problem with my bag' extracts only ['Billing'], missing Bag Manager docs entirely.\n\n**File:** response_generator.py:886-903\n**Problem:** Keyword-based service line detection is unreliable","acceptance_criteria":"- [ ] Consider searching all authorized service lines first\n- [ ] Use service line detection as boost, not filter\n- [ ] Or expand detected service lines to include related ones","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-04T14:40:37.918038+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-04T14:46:00.888724+05:30","closed_at":"2026-02-04T14:46:00.888735+05:30","labels":["critical","query-pipeline","retrieval"]}
{"id":"digihub-chatbot-aqk","title":"Add questionsEmbedding field to data pipeline","description":"**Type:** bug","acceptance_criteria":"- [ ] Generate synthetic questions for each chunk using LLM\n- [ ] Create questionsEmbedding from concatenated questions\n- [ ] Store both embedding and questionsEmbedding in document\n- [ ] Add questions array field for debugging\n\n---","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.263235+05:30","updated_at":"2026-02-04T12:22:57.576868+05:30","closed_at":"2026-02-04T12:22:57.576872+05:30","labels":["critical","data-pipeline","schema"]}
{"id":"digihub-chatbot-aut","title":"Implement metadata-based filtering in retrieval","description":"**Type:** enhancement","acceptance_criteria":"- [ ] Store metadata fields in chunks during indexing\n- [ ] Pass extracted metadata from query analyzer to retrieval\n- [ ] Add metadata filters to CosmosDB query\n- [ ] Implement fallback to unfiltered query if no results\n\n---","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.266247+05:30","updated_at":"2026-02-04T13:01:59.924425+05:30","closed_at":"2026-02-04T13:01:59.924425+05:30","close_reason":"Implemented metadata-based filtering in retrieval with ENABLE_METADATA_FILTERING config flag, supporting contentType and year filters from query analyzer","labels":["medium","query-pipeline"]}
{"id":"digihub-chatbot-boj","title":"Implement proper context formatting for LLM","description":"**Type:** enhancement","acceptance_criteria":"- [ ] Format context as structured markdown or numbered sections\n- [ ] Include clear labels for each chunk (source file, section heading)\n- [ ] Use proper JSON formatting if structure is needed\n\n---","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.265051+05:30","updated_at":"2026-02-04T12:53:47.052726+05:30","closed_at":"2026-02-04T12:53:47.05273+05:30","labels":["high","query-pipeline"]}
{"id":"digihub-chatbot-btu","title":"Remove duplicate translation key in JSON schema","description":"**Type:** bug","acceptance_criteria":"- [ ] Remove duplicate key\n- [ ] Consolidate instruction into one clear definition\n\n---","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.268125+05:30","updated_at":"2026-02-04T13:07:18.121267+05:30","closed_at":"2026-02-04T13:07:18.121267+05:30","close_reason":"Consolidated duplicate 'translation' keys in LANGUAGE_DETECTION_TEMPLATE JSON schema into single clear definition","labels":["low","query-pipeline"]}
{"id":"digihub-chatbot-cq5","title":"Consolidate out-of-scope detection to single consistent signal","description":"**Type:** bug\n\nOut-of-scope detection uses 4 contradictory signals that can fire independently, causing flaky behavior where same query gets different results.\n\n**File:** response_generator.py:687-768\n**Signals:** is_out_of_scope boolean, confidence\u003c0.4, text patterns, type=generic+confidence\u003c0.6","acceptance_criteria":"- [ ] Use single source of truth for out-of-scope (LLM is_out_of_scope boolean)\n- [ ] Remove conflicting confidence threshold checks\n- [ ] Remove text pattern matching fallback\n- [ ] Test consistency across repeated queries","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-04T14:40:30.041903+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-04T14:44:58.638499+05:30","closed_at":"2026-02-04T14:44:58.638516+05:30","labels":["critical","query-pipeline","response"]}
{"id":"digihub-chatbot-dww","title":"Add chunk quality validation in data pipeline","description":"**Type:** enhancement","acceptance_criteria":"- [ ] Implement minimum content length validation (\u003e50 tokens)\n- [ ] Check for meaningful content beyond just headers\n- [ ] Detect and filter duplicate/near-duplicate chunks\n- [ ] Set validChunk = \"no\" for low-quality chunks\n\n---\n\n# Low Priority Issues","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.267522+05:30","updated_at":"2026-02-04T13:03:45.919099+05:30","closed_at":"2026-02-04T13:03:45.919099+05:30","close_reason":"Implemented chunk quality validation with: 1) Token-based minimum content check (MIN_TOKEN_COUNT=50 tokens), 2) Header-only content detection, 3) Exact duplicate detection using content hash, 4) Near-duplicate detection using Jaccard similarity (threshold=0.85), 5) Placeholder content detection. Added reset_duplicate_tracking() called per-file in dataprocessor.","labels":["data-pipeline","medium"]}
{"id":"digihub-chatbot-dzp","title":"Remove MIN_RELEVANCE_CHUNKS forcing irrelevant content","description":"**Type:** bug\n\nWhen relevance judge returns fewer chunks than MIN_RELEVANCE_CHUNKS, code forces top N chunks by score even if they're irrelevant. This injects garbage into LLM context.\n\n**File:** response_generator.py:668-675\n**Problem:** If 0 chunks are relevant, still forces top 2 irrelevant chunks","acceptance_criteria":"- [ ] Don't force minimum chunks if relevance judge says none are relevant\n- [ ] Return empty/fewer chunks when appropriate\n- [ ] Let out-of-scope detection handle no-context cases","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-04T14:40:22.179668+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-04T14:44:14.844087+05:30","closed_at":"2026-02-04T14:44:14.844093+05:30","labels":["critical","filtering","query-pipeline"]}
{"id":"digihub-chatbot-ehd","title":"Fix conflicting out-of-scope instructions in prompt template","description":"**Type:** bug\n\nRESPONSE_TEMPLATE has contradictory instructions for out-of-scope detection that confuse the LLM.\n\n**File:** prompt_template.py:311-323\n**Conflicts:**\n- 'Set is_out_of_scope=true if confidence \u003c 0.4'\n- 'Set is_out_of_scope=true if confidence 0.4-0.6 AND tangential'\n- 'High confidence (\u003e0.7) = in scope'","acceptance_criteria":"- [ ] Simplify to single clear instruction\n- [ ] Remove conflicting threshold guidance\n- [ ] Test LLM consistency with updated prompt","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-04T14:40:54.812092+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-04T14:47:03.958846+05:30","closed_at":"2026-02-04T14:47:03.95886+05:30","labels":["critical","prompts","query-pipeline"]}
{"id":"digihub-chatbot-eip","title":"Fix hybrid scoring calculation for legacy chunks","description":"Fixed hybrid scoring for legacy chunks - apply 15% penalty and use content-only scoring","acceptance_criteria":"- [ ] Fix scoring to properly handle legacy chunks\n- [ ] Consider penalizing legacy chunks slightly\n- [ ] Log when legacy chunks are included in results","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-04T14:40:06.62656+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-04T14:42:05.788339+05:30","closed_at":"2026-02-04T14:42:05.788353+05:30","labels":["critical","query-pipeline","retrieval"]}
{"id":"digihub-chatbot-f1v","title":"Improve citation processing code pattern","description":"**Type:** enhancement","acceptance_criteria":"- [ ] Make modification pattern explicit by reassigning result\n- [ ] Add return statement and capture it\n\n---","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.268471+05:30","updated_at":"2026-02-04T13:08:11.364446+05:30","closed_at":"2026-02-04T13:08:11.364446+05:30","close_reason":"Fixed citation processing pattern: explicitly capture return value from _process_citations() and reassign to structured_response. Updated docstring to clarify return value usage.","labels":["low","query-pipeline"]}
{"id":"digihub-chatbot-gre","title":"Fix ORDER BY to use questionsEmbedding instead of content embedding","description":"Fixed ORDER BY to use questionsEmbedding instead of embedding","acceptance_criteria":"- [ ] Change ORDER BY to use c.questionsEmbedding\n- [ ] Add fallback for legacy chunks without questionsEmbedding\n- [ ] Test retrieval quality improvement","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-04T14:39:58.772019+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-04T14:41:39.21753+05:30","closed_at":"2026-02-04T14:41:39.217547+05:30","labels":["critical","query-pipeline","retrieval"]}
{"id":"digihub-chatbot-pvl","title":"Fix validChunk filter causing retrieval failures","description":"**Type:** bug","acceptance_criteria":"- [ ] Make filter conditional based on field existence\n- [ ] Add fallback query without filter if no results\n- [ ] Log when chunks are filtered by this condition\n\n---\n\n# High Priority Issues","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.264281+05:30","updated_at":"2026-02-04T12:26:37.047165+05:30","closed_at":"2026-02-04T12:26:37.047169+05:30","labels":["critical","query-pipeline","retrieval"],"dependencies":[{"issue_id":"digihub-chatbot-pvl","depends_on_id":"digihub-chatbot-111","type":"blocks","created_at":"2026-02-04T10:59:26.201899+05:30","created_by":"zohaibtanwir"}]}
{"id":"digihub-chatbot-sr0","title":"Implement structured out-of-scope detection","description":"**Type:** enhancement","acceptance_criteria":"- [ ] Add dedicated is_out_of_scope boolean to LLM response schema\n- [ ] Use confidence score thresholds as additional signal\n- [ ] Implement fuzzy matching or semantic similarity\n- [ ] Return structured response with explicit scope classification\n\n---","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.267171+05:30","updated_at":"2026-02-04T13:01:51.528495+05:30","closed_at":"2026-02-04T13:01:51.528495+05:30","close_reason":"Implemented structured out-of-scope detection with multiple signals: 1) Explicit is_out_of_scope boolean from LLM response schema, 2) Confidence score threshold (configurable via OUT_OF_SCOPE_CONFIDENCE_THRESHOLD, default 0.4), 3) Text-based matching fallback, 4) Generic type with low confidence check","labels":["medium","query-pipeline"]}
{"id":"digihub-chatbot-srv","title":"Split monolithic query analyzer prompt","description":"**Type:** enhancement","acceptance_criteria":"- [ ] Split into focused prompts for different concerns\n- [ ] Use smaller/faster models for simple tasks\n- [ ] Chain prompts with early exit conditions\n- [ ] Use structured output schemas (JSON mode) for each\n\n---","status":"in_progress","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.265408+05:30","updated_at":"2026-02-04T12:51:20.51799+05:30","labels":["high","query-pipeline"]}
{"id":"digihub-chatbot-syj","title":"Fix reference resolution disabled on service line change","description":"**Type:** bug\n\nReference resolution (resolving 'it', 'that', etc.) only runs when is_session_dependent=true. But when service lines change between questions, is_session_dependent is set to false, so pronouns are sent to retrieval unresolved.\n\n**File:** response_generator.py:489-499\n**Example:** 'Tell me more about it' sent as-is when topic changes","acceptance_criteria":"- [ ] Always check for references regardless of is_session_dependent\n- [ ] Resolve pronouns even when service line changes\n- [ ] Test with topic-switching conversations","status":"closed","priority":2,"issue_type":"task","owner":"zohaib.tanwir@gmail.com","created_at":"2026-02-04T14:40:14.473388+05:30","created_by":"zohaibtanwir","updated_at":"2026-02-04T14:43:32.752773+05:30","closed_at":"2026-02-04T14:43:32.752778+05:30","labels":["context","critical","query-pipeline"]}
{"id":"digihub-chatbot-uq3","title":"Enable hybrid re-ranking in retrieval service","description":"**Type:** bug","acceptance_criteria":"- [ ] Uncomment hybrid scoring code block (lines 324-358)\n- [ ] Ensure hybrid score properly weights question vs content similarity\n- [ ] Implement minimum question similarity threshold\n- [ ] Add logging for retrieval quality metrics\n\n---","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.261422+05:30","updated_at":"2026-02-04T12:26:37.232917+05:30","closed_at":"2026-02-04T12:26:37.23292+05:30","labels":["critical","query-pipeline","retrieval"],"dependencies":[{"issue_id":"digihub-chatbot-uq3","depends_on_id":"digihub-chatbot-aqk","type":"blocks","created_at":"2026-02-04T10:59:25.837839+05:30","created_by":"zohaibtanwir"},{"issue_id":"digihub-chatbot-uq3","depends_on_id":"digihub-chatbot-111","type":"blocks","created_at":"2026-02-04T10:59:26.013347+05:30","created_by":"zohaibtanwir"}]}
{"id":"digihub-chatbot-whj","title":"Add comprehensive logging and monitoring","description":"**Type:** enhancement","acceptance_criteria":"- [ ] Add retrieval quality metrics logging\n- [ ] Log similarity scores for all retrieved chunks\n- [ ] Add latency tracking for each pipeline stage\n- [ ] Implement health check endpoints with detailed status","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.268758+05:30","updated_at":"2026-02-04T13:10:11.558734+05:30","closed_at":"2026-02-04T13:10:11.558734+05:30","close_reason":"Added comprehensive logging and monitoring: 1) Created src/utils/metrics.py with RetrievalMetrics, LatencyTracker, PipelineMetrics classes, 2) Added /actuator/health/detailed endpoint with CosmosDB and Azure OpenAI status checks and config reporting, 3) Integrated RetrievalMetrics.log_chunk_scores() for all retrieved chunks, 4) Added RetrievalMetrics.log_filtering_results() for threshold and relevance filtering","labels":["low","observability"]}
{"id":"digihub-chatbot-xkz","title":"Add minimum similarity threshold for retrieval","description":"**Type:** enhancement","acceptance_criteria":"- [ ] Set meaningful default threshold (0.3-0.4)\n- [ ] Make threshold configurable via environment variable\n- [ ] Log similarity scores for quality monitoring\n- [ ] Consider adaptive thresholds based on query type\n\n---","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-04T10:58:34.266544+05:30","updated_at":"2026-02-04T13:01:59.720443+05:30","closed_at":"2026-02-04T13:01:59.720443+05:30","close_reason":"Added MIN_SIMILARITY_THRESHOLD config (default 0.35) for retrieval quality control with logging of top 5 hybrid scores","labels":["medium","query-pipeline"]}
